fetch('https://stappaf1.github.io/Menu/KALENDERECO.json')
    .then(response => {
        if (!response.ok) {
            throw new Error('Netzwerkantwort war nicht ok');
        }
        return response.json();
    })
    .then(data => {
        const eventContainer = document.getElementById('event-container');
        
        // Holen Sie sich das heutige Datum im Format DD.MM.YY
        const today = new Date();
        const options = { day: '2-digit', month: '2-digit', year: '2-digit' };
        const formattedDate = today.toLocaleDateString('de-DE', options);
        
        // Filtere die Veranstaltungen nach dem heutigen Datum
        const todayEvents = data.events.filter(event => event.DATUM === formattedDate);
        
        // Prüfen, ob es Veranstaltungen gibt
        if (todayEvents.length === 0) {
            document.getElementById('error-message').textContent = 'Heute sind keine Veranstaltungen geplant.';
            return;
        }

        // Berechnen Sie die Höhe der Zeilen
        const totalHeight = window.innerHeight - (document.querySelector('.header').offsetHeight + document.querySelector('footer').offsetHeight);
        const rowHeight = totalHeight / todayEvents.length; // Höhe jeder Zeile

        todayEvents.forEach(event => {
            const row = document.createElement('div');
            row.classList.add('event-row');
            row.style.height = `${rowHeight}px`; // Setze die Höhe

            // Erstellen Sie die HTML-Struktur für das Event
            const timeText = event.BIS ? `${event.VON} bis ${event.BIS}` : `ab ${event.VON}`;
            const eventHTML = `
                <img src="${event.BILD}" alt="${event.TAGUNGSRAUM}" class="event-image"/>
                <div>
                    <strong>${event.KUNDE}</strong><br>
                    <p>${event.EVENT || 'Kein Event'}</p>
                    <p>${timeText}</p>
                    <p>Raum: ${event.TAGUNGSRAUM} ${event.RAUMHINWEIS ? `(${event.RAUMHINWEIS})` : ''} ${event.TEILNEHMER > 0 ? `(${event.TEILNEHMER})` : ''}</p>
                </div>
                <div>
                    <p>${event.BEMERKUNG}</p>
                </div>
            `;
            row.innerHTML = eventHTML;
            eventContainer.appendChild(row);
        });
    })
    .catch(error => {
        document.getElementById('error-message').textContent = `Fehler beim Laden der JSON-Daten: ${error.message}`;
    });
